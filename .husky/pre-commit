#!/usr/bin/env sh
set -e
. "$(dirname -- "$0")/_/husky.sh"

echo "Hello Learn ReactJs For Tai Dev"

# Run lint-staged or other pre-commit tasks
npm run lint-staged

# Infomation for me success or error
echo "---- Oh my good prefetch üî• ----"

# Ki·ªÉm tra xem t·ªáp commit message t·ªìn t·∫°i kh√¥ng
if [ -f "$1" ] && [ -s "$1" ]; then
  # L·∫•y commit message t·ª´ t·ªáp
  COMMIT_MESSAGE=$(cat "$1")

  # Ki·ªÉm tra xem commit message ch·ª©a "feat" ho·∫∑c "feature" kh√¥ng
  if echo "$COMMIT_MESSAGE" | grep -qiE "(feat|feature)"; then
    # Xu·∫•t bi·∫øn m√¥i tr∆∞·ªùng ƒë·ªÉ th√¥ng b√°o v·ªÅ vi·ªác tƒÉng version
    export VERSION_BUMPED=true
    # Ch·∫°y standard-version ƒë·ªÉ tƒÉng version
    npx standard-version
  else
    # Commit message kh√¥ng ch·ª©a "feat" ho·∫∑c "feature"
    echo "Commit message must contain 'feat' or 'feature'."
  fi
else
  # T·ªáp commit message kh√¥ng t·ªìn t·∫°i ho·∫∑c tr·ªëng
  echo "Commit message file does not exist or is empty."
fi

# Push to remote repository (origin) on successful commit
git push origin HEAD
